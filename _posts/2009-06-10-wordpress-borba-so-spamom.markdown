--- 
layout: post
title: !binary |
  d29yZHByZXNzIC0g0LHQvtGA0YzQsdCwINGB0L4g0YHQv9Cw0LzQvtC8Li4u
keywords: wordpress,spam,apache
date: 2009-06-10
tags:
  - wordpress
  - spam
  - apache


---
По мере роста популярности сайта проблема спама в комментариях становиться все более и более актуальной.

На сегодняшний день существует целый ряд расширений для wordpress, призванных облегчить борьбу с этой гадостью. Но некоторые расширения делают это за счет того, что пользователям приходиться дополнительно подтверждать, что они люди, либо возлагают на администратора сайта дополнительную работу.

До сих пор мне удалось найти только два расширения, которые очень эффективно борются со спамом в комментариях - это стандартный Akismet и расширение, про которое я уже писал  - WP-SpamFree.

WP-SpamFree очень эффективно отслеживает спам-ботов (используется две технологии, это обязательно должен быть включен java-script и кукисы у пользователя, для того, чтобы отправить комментарий), а спам от людей отсеивается с помощью Akismet, за счет взаимодействия с базой спамеров на офсайте данного расширения.

Но на днях я встретил еще один очень интересный метод борьбы со спам-ботами. Принцип действия основан на том, что спам-боты удаленно обращаются к файлу wp-comments-post.php и соответственно реферал у запроса будет отличен от домена сайта. Поэтому просто добавляем строки в файл <em>.htaccess</em>:
<pre># BEGIN WordPress
&lt;IfModule mod_rewrite.c&gt;
RewriteEngine On
RewriteBase /
RewriteCond %&#123;REQUEST_FILENAME} !-f
RewriteCond %&#123;REQUEST_FILENAME} !-d
RewriteRule . /index.php [L]

<strong>RewriteCond %&#123;REQUEST_METHOD} POST
RewriteCond %&#123;REQUEST_URI} .wp-comments-post.php*
RewriteCond %&#123;HTTP_REFERER} !.*juev.ru.* [OR]
RewriteCond %&#123;HTTP_USER_AGENT} ^$
RewriteRule (.*) ^http://%&#123;REMOTE_ADDR}/$ [R=301,L]</strong>
&lt;/IfModule&gt;
# END WordPress</pre>
Добавленные строки выделены жирным, и вместо juev.ru нужно будет вписать свой домен.

После добавления данных строк, плагин WP-SpamFree остановил свой счет на 117 спам-комментариях, это значение, которое он набрал до того, как были вписаны эти строки. В тоже время, комментарии с сайта прекрасно отправляются (проверено). Просто до безобразия и очень эффективно. Рекомендую к использованию!
